<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>以太网协议详解 | hl0rey&#39;s blog</title>
  <meta name="keywords" content=" python ">
  <meta name="description" content="以太网协议详解 | hl0rey&#39;s blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="http://hl0rey.github.io/categories/index.html">
<meta property="og:site_name" content="hl0rey&#39;s blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-01-31T07:43:16.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="categories">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1" ></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.0.1" ></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value="">
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>hl0rey</span>
</div>

<div class="icon">
    
        
        <a title="rss" href="/atom.xml" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-rss"></use>
                </svg>
            
        </a>
        
    
        
        <a title="github" href="https://github.com/hl0rey" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:hl0rey@hl0rey.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=872336115&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(34)</small></div></li>
    
        
            
            <li><div data-rel="code">code<small>(13)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="reverse">reverse<small>(5)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="tools">tools<small>(6)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="linux">linux<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="pentest">pentest<small>(4)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="test">test<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="web">web<small>(1)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="34">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://www.free04k.cn/">Free04k</a></li>
            
            <li><a target="_blank" href="https://patrilic.top/">Patrilic</a></li>
            
            <li><a target="_blank" href="https://b1eed.github.io/">1x2Bytes</a></li>
            
            <li><a target="_blank" href="/www.Se7ensec.cn">Se7en</a></li>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode === 13){return false;}">
        <input id="local-search-input" class="search" type="text" placeholder="Search..." />
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a class="color2">python</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">php</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">OD</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">burpsuite</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">charset</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">mimikatz</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">proxy</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">test</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">msf</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">API</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Cobalt Strike</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">activedirectory</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">pte</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">nmap</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <nav id="title-list-nav">
        
        <a  class="code "
           href="/2018/02/08/150行代码写成的可扩展的代码审计辅助工具/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="150行代码写成的可扩展的代码审计辅助工具">150行代码写成的可扩展的代码审计辅助工具</span>
            <span class="post-date" title="2018-02-08 19:18:51">2018/02/08</span>
        </a>
        
        <a  class="code "
           href="/2018/02/17/ARP协议详解/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="ARP协议详解">ARP协议详解</span>
            <span class="post-date" title="2018-02-17 22:48:20">2018/02/17</span>
        </a>
        
        <a  class=""
           href="/2019/09/16/AD中的黄金票据与白银票据/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="AD中的黄金票据与白银票据">AD中的黄金票据与白银票据</span>
            <span class="post-date" title="2019-09-16 15:21:50">2019/09/16</span>
        </a>
        
        <a  class=""
           href="/2019/09/20/ErpnextV12-SSTI-vulnerability/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ErpnextV12 SSTI vulnerability">ErpnextV12 SSTI vulnerability</span>
            <span class="post-date" title="2019-09-20 09:57:59">2019/09/20</span>
        </a>
        
        <a  class="code "
           href="/2018/02/06/PHP使用了PDO的情况下可能产生注入的情况/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="PHP使用了PDO的情况下可能产生注入的情况">PHP使用了PDO的情况下可能产生注入的情况</span>
            <span class="post-date" title="2018-02-06 16:15:43">2018/02/06</span>
        </a>
        
        <a  class="reverse "
           href="/2018/02/07/OD中的各种断点/"
           data-tag="OD"
           data-author="" >
            <span class="post-title" title="OD中的各种断点">OD中的各种断点</span>
            <span class="post-date" title="2018-02-07 21:27:49">2018/02/07</span>
        </a>
        
        <a  class="tools "
           href="/2018/02/03/burpsuite-Target Spider Scanner Repeater Decoder Comparer模块/"
           data-tag="burpsuite"
           data-author="" >
            <span class="post-title" title="burpsuite-Target Spider Scanner Repeater Decoder Comparer模块">burpsuite-Target Spider Scanner Repeater Decoder Comparer模块</span>
            <span class="post-date" title="2018-02-03 16:42:20">2018/02/03</span>
        </a>
        
        <a  class="tools "
           href="/2018/02/02/burpsuite优化配置/"
           data-tag="burpsuite"
           data-author="" >
            <span class="post-title" title="burpsuite优化配置">burpsuite优化配置</span>
            <span class="post-date" title="2018-02-02 11:21:57">2018/02/02</span>
        </a>
        
        <a  class="tools "
           href="/2018/02/02/burpsuite截获流量/"
           data-tag="burpsuite"
           data-author="" >
            <span class="post-title" title="burpsuite截获流量">burpsuite截获流量</span>
            <span class="post-date" title="2018-02-02 12:18:03">2018/02/02</span>
        </a>
        
        <a  class="linux "
           href="/2018/04/01/debian解决终端编码报错/"
           data-tag="charset"
           data-author="" >
            <span class="post-title" title="debian解决终端编码报错">debian解决终端编码报错</span>
            <span class="post-date" title="2018-04-01 16:28:48">2018/04/01</span>
        </a>
        
        <a  class="pentest "
           href="/2019/07/18/mimikatz中的tspkg、MSV1-0、WDigest、kerberos/"
           data-tag="mimikatz"
           data-author="" >
            <span class="post-title" title="mimikatz中的tspkg、MSV1_0、WDigest、kerberos">mimikatz中的tspkg、MSV1_0、WDigest、kerberos</span>
            <span class="post-date" title="2019-07-18 10:40:27">2019/07/18</span>
        </a>
        
        <a  class="code "
           href="/2018/02/10/php-ini的不安全配置/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="php.ini的不安全配置">php.ini的不安全配置</span>
            <span class="post-date" title="2018-02-10 21:27:45">2018/02/10</span>
        </a>
        
        <a  class="code "
           href="/2018/02/07/php代码审计思维导图/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="php代码审计思维导图">php代码审计思维导图</span>
            <span class="post-date" title="2018-02-07 22:38:10">2018/02/07</span>
        </a>
        
        <a  class="code "
           href="/2018/02/23/代码审计之XSS/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="代码审计之XSS">代码审计之XSS</span>
            <span class="post-date" title="2018-02-23 18:45:18">2018/02/23</span>
        </a>
        
        <a  class="tools "
           href="/2018/02/03/proxychains配置详解/"
           data-tag="proxy"
           data-author="" >
            <span class="post-title" title="proxychains配置详解">proxychains配置详解</span>
            <span class="post-date" title="2018-02-03 21:27:08">2018/02/03</span>
        </a>
        
        <a  class="code "
           href="/2018/02/11/代码审计之SQL注入/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="代码审计之SQL注入">代码审计之SQL注入</span>
            <span class="post-date" title="2018-02-11 12:45:55">2018/02/11</span>
        </a>
        
        <a  class="code "
           href="/2018/02/25/代码审计之csrf/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="代码审计之csrf">代码审计之csrf</span>
            <span class="post-date" title="2018-02-25 21:20:45">2018/02/25</span>
        </a>
        
        <a  class="code "
           href="/2018/02/25/代码审计之文件上传/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="代码审计之文件上传">代码审计之文件上传</span>
            <span class="post-date" title="2018-02-25 21:21:02">2018/02/25</span>
        </a>
        
        <a  class="code "
           href="/2018/02/10/代码审计大的思路/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="代码审计大的思路">代码审计大的思路</span>
            <span class="post-date" title="2018-02-10 21:06:12">2018/02/10</span>
        </a>
        
        <a  class="reverse "
           href="/2018/02/08/反调试之IsDebuggerPresent/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="反调试之IsDebuggerPresent">反调试之IsDebuggerPresent</span>
            <span class="post-date" title="2018-02-08 17:19:20">2018/02/08</span>
        </a>
        
        <a  class="reverse "
           href="/2018/02/13/反调试之检测标题名和类名/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="反调试之检测标题名和类名">反调试之检测标题名和类名</span>
            <span class="post-date" title="2018-02-13 10:27:39">2018/02/13</span>
        </a>
        
        <a  class="reverse "
           href="/2018/02/10/反调试之检测进程名/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="反调试之检测进程名">反调试之检测进程名</span>
            <span class="post-date" title="2018-02-10 11:01:26">2018/02/10</span>
        </a>
        
        <a  class="test "
           href="/2019/07/17/备份恢复测试/"
           data-tag="test"
           data-author="" >
            <span class="post-title" title="备份恢复测试">备份恢复测试</span>
            <span class="post-date" title="2019-07-17 11:42:56">2019/07/17</span>
        </a>
        
        <a  class="tools "
           href="/2018/02/08/网页表单调用以外的钓鱼方法/"
           data-tag="msf"
           data-author="" >
            <span class="post-title" title="网页表单调用以外的钓鱼方法">网页表单调用以外的钓鱼方法</span>
            <span class="post-date" title="2018-02-08 19:12:52">2018/02/08</span>
        </a>
        
        <a  class=""
           href="/2019/09/18/进程保护技术学习和总结/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="进程保护技术学习和总结">进程保护技术学习和总结</span>
            <span class="post-date" title="2019-09-18 10:27:17">2019/09/18</span>
        </a>
        
        <a  class="reverse "
           href="/2018/02/10/隐式地调用系统API/"
           data-tag="API"
           data-author="" >
            <span class="post-title" title="隐式地调用系统API">隐式地调用系统API</span>
            <span class="post-date" title="2018-02-10 19:55:54">2018/02/10</span>
        </a>
        
        <a  class="pentest "
           href="/2019/07/17/MalleableC2总结/"
           data-tag="Cobalt Strike"
           data-author="" >
            <span class="post-title" title="MalleableC2总结">MalleableC2总结</span>
            <span class="post-date" title="2019-07-17 13:14:20">2019/07/17</span>
        </a>
        
        <a  class="code "
           href="/2018/02/19/代码审计之命令执行/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="代码审计之命令执行">代码审计之命令执行</span>
            <span class="post-date" title="2018-02-19 15:36:11">2018/02/19</span>
        </a>
        
        <a  class="code "
           href="/2018/02/19/代码审计之代码执行/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="代码审计之代码执行">代码审计之代码执行</span>
            <span class="post-date" title="2018-02-19 15:34:35">2018/02/19</span>
        </a>
        
        <a  class="code "
           href="/2018/02/18/以太网协议详解/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="以太网协议详解">以太网协议详解</span>
            <span class="post-date" title="2018-02-18 21:02:34">2018/02/18</span>
        </a>
        
        <a  class="pentest "
           href="/2019/07/17/域内信息收集/"
           data-tag="activedirectory"
           data-author="" >
            <span class="post-title" title="域内信息收集">域内信息收集</span>
            <span class="post-date" title="2019-07-17 12:47:58">2019/07/17</span>
        </a>
        
        <a  class="web "
           href="/2018/02/04/http协议详解/"
           data-tag="pte"
           data-author="" >
            <span class="post-title" title="http协议详解">http协议详解</span>
            <span class="post-date" title="2018-02-04 19:06:57">2018/02/04</span>
        </a>
        
        <a  class="pentest "
           href="/2019/09/06/利用External-C2让内网机器在Cobalt-Strike中上线/"
           data-tag="Cobalt Strike"
           data-author="" >
            <span class="post-title" title="利用External C2让内网机器在Cobalt Strike中上线">利用External C2让内网机器在Cobalt Strike中上线</span>
            <span class="post-date" title="2019-09-06 09:18:29">2019/09/06</span>
        </a>
        
        <a  class="tools "
           href="/2018/01/31/nmap-7-6-手册/"
           data-tag="nmap"
           data-author="" >
            <span class="post-title" title="nmap 7.6 手册">nmap 7.6 手册</span>
            <span class="post-date" title="2018-01-31 15:09:23">2018/01/31</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-以太网协议详解" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">以太网协议详解</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            
                <a  data-rel="code">code</a>
            
        </span>
        
        
        <span class="tag">
            
            <a class="color2">python</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title='更新时间: 2018-02-21 22:11:40'>2018-02-18 21:02</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#各协议在模型中的位置"><span class="toc-text">各协议在模型中的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#简介"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据包结构详解"><span class="toc-text">数据包结构详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scapy"><span class="toc-text">scapy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#scapy的几个发包的方法"><span class="toc-text">scapy的几个发包的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看scapy内置的工具："><span class="toc-text">查看scapy内置的工具：</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>参考链接<br><a href="http://blog.csdn.net/xiao628945/article/details/8006022" target="_blank" rel="noopener">http://blog.csdn.net/xiao628945/article/details/8006022</a></p>
<h3 id="各协议在模型中的位置"><a href="#各协议在模型中的位置" class="headerlink" title="各协议在模型中的位置"></a>各协议在模型中的位置</h3><pre><code>TCP/IP: 
网络接口层（链路层）：
网络层： IP,ICMP,IGMP，【ARP,RARP】
传输层：TCP ,UDP,UGP
应用层：Telnet,FTP,SMTP,SNMP.

OSI:
物理层：EIA/TIA-232, EIA/TIA-499, V.35, V.24, RJ45, Ethernet, 802.3, 802.5, FDDI, NRZI, NRZ, B8ZS
数据链路层：Frame Relay, HDLC, PPP, IEEE 802.3/802.2, FDDI, ATM,  IEEE 802.5/802.2
网络层：IP，IPX，AppleTalk DDP，【ARP,RARP】
传输层：TCP，UDP，SPX
会话层：RPC,SQL,NFS,NetBIOS,names,AppleTalk,ASP,DECnet,SCP
表示层:TIFF,GIF,JPEG,PICT,ASCII,EBCDIC,encryption,MPEG,MIDI,HTML
应用层：FTP,WWW,Telnet,NFS,SMTP,Gateway,SNMP
</code></pre><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><pre><code>以太网协议中应用最广泛的是　Ethernet II　协议，也是 scapy 支持的协议．
</code></pre><h3 id="数据包结构详解"><a href="#数据包结构详解" class="headerlink" title="数据包结构详解"></a>数据包结构详解</h3><p><img src="/2018/02/18/以太网协议详解/1.png" alt=""> </p>
<ul>
<li><p>包头结构</p>
<pre><code>typedef struct ethdr //以太网包头14字节
{
unsigned char destination_mac[6];//目标MAC 6字节
unsigned char source_mac[6];//源MAC 6字节
unsigned short type;//后面的协议类型2字节 为0806表示后面跟的包为ARP包
}ET_HEADER,*PETHDR; 
</code></pre></li>
<li><p>type字段的常见值及其意义<br><img src="/2018/02/18/以太网协议详解/2.png" alt=""> </p>
<pre><code>Ethertype ( 十六进制 )   协议   
0x0000 - 0x05DC   IEEE 802.3 长度   
0x0101 – 0x01FF   实验   
0x0600   XEROX NS IDP   
0x0660 0x0661   DLOG   
0x0800   网际协议（IP）   
0x0801   X.75 Internet   
0x0802   NBS Internet   
0x0803   ECMA Internet   
0x0804   Chaosnet   
0x0805   X.25 Level 3   
0x0806   地址解析协议（ARP ： Address Resolution Protocol）   
0x0808   帧中继 ARP （Frame Relay ARP） [RFC1701]   
0x6559   原始帧中继（Raw Frame Relay） [RFC1701]   
0x8035   动态 DARP （DRARP：Dynamic RARP） 反向地址解析协议（RARP：Reverse Address Resolution Protocol）   
0x8037   Novell Netware IPX   
0x809B   EtherTalk   
0x80D5   IBM SNA Services over Ethernet   
0x 80F 3   AppleTalk 地址解析协议（AARP：AppleTalk Address Resolution Protocol）   
0x8100   以太网自动保护开关（EAPS：Ethernet Automatic Protection Switching）   
0x8137   因特网包交换（IPX：Internet Packet Exchange）   
0x 814C   简单网络管理协议（SNMP：Simple Network Management Protocol）   
0x86DD   网际协议v6 （IPv6，Internet Protocol version 6）   
0x880B   点对点协议（PPP：Point-to-Point Protocol）   
0x 880C   通用交换管理协议（GSMP：General Switch Management Protocol）   
0x8847   多协议标签交换（单播） MPLS：Multi-Protocol Label Switching &lt;unicast&gt;）   
0x8848   多协议标签交换（组播）（MPLS, Multi-Protocol Label Switching &lt;multicast&gt;）   
0x8863   以太网上的 PPP（发现阶段）（PPPoE：PPP Over Ethernet &lt;Discovery Stage&gt;）   
0x8864   以太网上的 PPP（PPP 会话阶段） （PPPoE，PPP Over Ethernet&lt;PPP Session Stage&gt;）   
0x88BB   轻量级访问点协议（LWAPP：Light Weight Access Point Protocol）   
0x88CC   链接层发现协议（LLDP：Link Layer Discovery Protocol）   
0x8E88   局域网上的 EAP（EAPOL：EAP over LAN）   
0x9000   配置测试协议（Loopback）   
0x9100   VLAN 标签协议标识符（VLAN Tag Protocol Identifier）   
0x9200   VLAN 标签协议标识符（VLAN Tag Protocol Identifier）   
0xFFFF   保留
</code></pre><h3 id="scapy"><a href="#scapy" class="headerlink" title="scapy"></a>scapy</h3><p>  执行 ls(Ether)，回显如下：</p>
<p>  dst        : DestMACField         = (None) //目的MAC<br>  src        : SourceMACField       = (None)//源MAC<br>  type       : XShortEnumField      = (36864)//上层协议类型</p>
</li>
</ul>
<pre><code>通常不用手动构造以太头
</code></pre><h4 id="scapy的几个发包的方法"><a href="#scapy的几个发包的方法" class="headerlink" title="scapy的几个发包的方法"></a>scapy的几个发包的方法</h4><pre><code>send()方法在三层定义和发送数据包，也就是说，用户不用自己考虑路由（不用自己选接口），和以太头．

    send(IP(dst=&quot;www.baidu.com&quot;)/ICMP())
    .
    Sent 1 packets.



sendp()方法在二层定义和发送数据包，需要自己指定接口，和加上以太头．

    sendp(Ether()/IP(dst=&quot;www.baidu.com&quot;)/ICMP(),iface=&quot;wlan0&quot;,loop=1,inter=0.2)

    loop=1时循环发包，等于0时不循环．
    inter是发包的秒数间隔

sr()方法在三层发包，返回一个元组，

    n [32]: i
    Out[32]: 
    (&lt;Results: TCP:0 UDP:0 ICMP:1 Other:0&gt;,
     &lt;Unanswered: TCP:0 UDP:0 ICMP:0 Other:0&gt;)


    In [36]: i[0].summary()
    IP / ICMP 192.168.1.104 &gt; 111.13.100.92 echo-request 0 ==&gt; IP / ICMP 111.13.100.92 &gt; 192.168.1.104 echo-reply 0

    In [37]: i[0].show
    Out[37]: &lt;bound method PacketList.show of &lt;Results: TCP:0 UDP:0 ICMP:1 Other:0&gt;&gt;

    In [38]: i[0].show()
    0000 IP / ICMP 192.168.1.104 &gt; 111.13.100.92 echo-request 0 ==&gt; IP / ICMP 111.13.100.92 &gt; 192.168.1.104 echo-reply 0

    In [39]: i[1].show()

    In [40]: 

sr1()方法，只返回一个相应包
srp()方法在二层发包．
</code></pre><h4 id="查看scapy内置的工具："><a href="#查看scapy内置的工具：" class="headerlink" title="查看scapy内置的工具："></a>查看scapy内置的工具：</h4><pre><code>lsc()

回显：

arpcachepoison      : 向目标机器ARP缓存投毒，指定一个这样的 (your MAC,victim&apos;s IP) 元组．
arping              : 发送ARP who-has requests 来扫描存活主机
bind_layers         : Bind 2 layers on some specific fields&apos; values
bridge_and_sniff    : Forward traffic between two interfaces and sniff packets exchanged
corrupt_bits        : Flip a given percentage or number of bits from bytes
corrupt_bytes       : Corrupt a given percentage or number of bytes from bytes
defrag              : defrag(plist) -&gt; ([not fragmented], [defragmented],
defragment          : defragment(plist) -&gt; plist defragmented as much as possible 
dyndns_add          : Send a DNS add message to a nameserver for &quot;name&quot; to have a new &quot;rdata&quot;
dyndns_del          : Send a DNS delete message to a nameserver for &quot;name&quot;
etherleak           : Exploit Etherleak flaw
fragment            : Fragment a big IP datagram
fuzz                : Transform a layer into a fuzzy layer by replacing some default values by random objects
getmacbyip          : Return MAC address corresponding to a given IP address
hexdiff             : Show differences between 2 binary strings
hexdump             : --
hexedit             : Run external hex editor on a packet or bytes. Set editor in conf.prog.hexedit
is_private_addr     : Returns True if the IPv4 Address is an RFC 1918 private address.
is_promisc          : Try to guess if target is in Promisc mode. The target is provided by its ip.
linehexdump         : --
ls                  : List  available layers, or infos on a given layer
mtr                 : A Multi-Traceroute (mtr) command:
promiscping         : Send ARP who-has requests to determine which hosts are in promiscuous mode
rdpcap              : Read a pcap file and return a packet list
send                : Send packets at layer 3
sendp               : Send packets at layer 2
sendpfast           : Send packets at layer 2 using tcpreplay for performance
sniff               : Sniff packets
split_layers        : Split 2 layers previously bound
sr                  : Send and receive packets at layer 3
sr1                 : Send packets at layer 3 and return only the first answer
srbt                : send and receive using a bluetooth socket
srbt1               : send and receive 1 packet using a bluetooth socket
srflood             : Flood and receive packets at layer 3
srloop              : Send a packet at layer 3 in loop and print the answer each time
srp                 : Send and receive packets at layer 2
srp1                : Send and receive packets at layer 2 and return only the first answer
srpflood            : Flood and receive packets at layer 2
srploop             : Send a packet at layer 2 in loop and print the answer each time
tdecode             : Run tshark to decode and display the packet. If no args defined uses -V
traceroute          : Instant TCP traceroute
tshark              : Sniff packets and print them calling pkt.show(), a bit like text wireshark
wireshark           : Run wireshark on a list of packets
wrpcap              : Write a list of packets to a pcap file
</code></pre><p>值得一提的是srbt那一堆方法．        </p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 jaytp@qq.com </span>
    </div>
</article>



<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>以太网协议详解</p>
    
    <p><span class="copy-title">本文作者:</span><a  title="hl0rey">hl0rey</a></p>
    <p><span class="copy-title">发布时间:</span>2018-02-18, 21:02:34</p>
    <p><span class="copy-title">最后更新:</span>2018-02-21, 22:11:40</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2018/02/18/以太网协议详解/" title="以太网协议详解">http://hl0rey.github.io/2018/02/18/以太网协议详解/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>





    




    </div>
    <div class="copyright">
        <p class="footer-entry">©2016-9999 hl0rey</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" ></a>

    </div>
</div>
<div class="acParent"></div>

</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#python','#php','#OD','#burpsuite','#charset','#mimikatz','#proxy','#test','#msf','#API','#Cobalt Strike','#activedirectory','#pte','#nmap',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: #fafafa;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
